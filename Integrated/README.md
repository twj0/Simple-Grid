# 基于深度强化学习的微电网能量管理系统

## 项目简介

本项目实现了一个基于深度强化学习(DRL)的微电网能量管理系统，通过优化电池储能系统的充放电策略，实现微电网的经济高效运行。系统考虑了光伏发电的间歇性、负载需求的变化、实时电价波动以及电池寿命等多种因素，通过DDPG（深度确定性策略梯度）算法学习最优控制策略。

## 功能特点

- **智能电池控制**：基于DRL的电池充放电策略，平衡经济性和电池寿命
- **多因素优化**：同时考虑光伏发电、负载需求、电价波动和电池寿命
- **真实随机数据**：生成具有真实随机性的光伏功率、负载功率和电价数据
- **可视化分析**：提供系统功率平衡、SOC与电价关系、SOH退化等可视化结果

## 系统架构

项目基于MATLAB/Simulink实现，主要包括以下组件：

1. **Simulink模型**：`Microgrid2508020734.slx` - 微电网物理模型，包含光伏、负载、电池和电网
2. **数据生成模块**：`create_dataset.m` - 生成仿真所需的随机输入数据
3. **DRL训练模块**：`run_drl_experiment.m` - 实现DDPG算法训练过程
4. **问题诊断与修复**：多个脚本用于解决环境配置、观测问题等
5. **预训练智能体**：`saved_agents/` 目录下保存了多个预训练智能体

## 技术细节

### 深度强化学习实现

- **算法**：DDPG（深度确定性策略梯度）
- **Actor网络**：7维输入，128-64-1结构，tanh激活函数
- **Critic网络**：状态和动作双路输入，加法融合，128-64-1结构
- **探索策略**：Ornstein-Uhlenbeck噪声，带衰减方差
- **经验回放**：容量为1e6的经验缓冲区，批量大小128

### 微电网模型

- **光伏系统**：最大功率500kW，具有日变化和小时波动
- **电池系统**：额定容量100kWh，效率96%，SOC范围15%-95%
- **负载模型**：具有日变化和小时波动的用电负荷
- **电网交互**：双向功率流，考虑实时电价

### 奖励函数设计

奖励函数综合考虑以下因素：
1. 电网购电成本（负值）
2. 电网售电收益（正值）
3. 电池寿命损失成本（负值）
4. SOC越界惩罚（负值）

## 使用指南

### 环境要求

- MATLAB R2024a/R2025a
- Simulink
- Reinforcement Learning Toolbox
- Deep Learning Toolbox
- 推荐：GPU加速支持（需Parallel Computing Toolbox）

### 快速开始

1. **生成仿真数据**
   ```matlab
   run('create_dataset.m')